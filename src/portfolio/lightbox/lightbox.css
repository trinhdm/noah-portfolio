.lightbox {
	display: flex;
	overflow-x: clip;
	z-index: 9999;

	&:not(.lightbox--animated):has(.fe-block:not(.lightbox--animated)) {
		/* structure */
		.lightbox__body,
		.lightbox__container,
		.lightbox__overlay,
		/* buttons */
		.lightbox__button  {
			opacity: 1;
		}

		.lightbox__body,
		.lightbox__container {
			transform: var(--dt-fade-base);
		}
	}

	&.lightbox--animated:has(.fe-block:not(.lightbox--animated)) {
		--dt-lb-duration: .625s;
		--dt-lb-delay-body: .1s;
		--dt-lb-time-btn: .2s;

		--dt-lb-stagger: calc(2 * var(--dt-lb-delay-body));
		--dt-lb-timeframe: calc(var(--dt-lb-duration) + var(--dt-lb-stagger));

		/* structure */
		.lightbox__body,
		.lightbox__container,
		.lightbox__overlay,
		/* buttons */
		.lightbox__button {
			animation-fill-mode: forwards;
		}

		.lightbox__arrow > span,
		.lightbox__button,
		.lightbox__overlay {
			animation-name: fadeIn;
		}

		.lightbox__button {
			animation-duration: calc(.75 * var(--dt-lb-duration));
			animation-timing-function: var(--ease-in-out-sine);

			&.lightbox__next {
				animation-name: fadeInLeft;
				transform-origin: left;
			}

			&.lightbox__prev {
				animation-name: fadeInRight;
				transform-origin: right;
			}
		}

		.lightbox__body,
		.lightbox__container {
			animation-duration: var(--dt-lb-duration);
			animation-name: fadeInUp;
		}

		.lightbox__overlay {
			animation-duration: var(--dt-lb-duration);
			animation-timing-function: var(--ease-in-out-back);
		}

		/*	on fade out
			-----------------	*/

		&:not(.lightbox--active) {
			/* structure */
			.lightbox__body,
			.lightbox__container,
			.lightbox__overlay,
			/* buttons */
			.lightbox__button  {
				animation-direction: reverse;
				opacity: 1;
			}

			.lightbox__body,
			.lightbox__container {
				transform: var(--dt-fade-base);
			}

			.lightbox__body {
				/* animation-delay: calc(2 * var(--dt-lb-timeframe)); */
				animation-delay: var(--dt-lb-timeline);
				animation-timing-function: var(--ease-out-quart);
			}

			.lightbox__container {
				/* animation-delay: calc(var(--dt-lb-time-btn) + var(--dt-lb-delay-body)); */
				/* animation-delay: calc(var(--dt-lb-timeline) + var(--dt-lb-duration)); */

				/* animation-delay: calc(2 * var(--dt-lb-timeframe)); */
				animation-delay: var(--dt-lb-delay-body);
				animation-timing-function: var(--ease-out-quad);
			}

			.lightbox__overlay {
				animation-delay: calc(2 * var(--dt-lb-timeframe));
				/* animation-delay: calc(var(--dt-lb-timeline) + var(--dt-lb-duration) + var(--dt-lb-stagger)); */
				/* animation-delay: calc(.5 * var(--dt-lb-timeframe)); */
			}

			.lightbox__button  {
				animation-delay: calc(.5 * var(--dt-lb-duration));

				&.lightbox__next,
				&.lightbox__prev {
					animation-delay: 0s;
				}
			}
		}

		/*	on fade in
			-----------------	*/

		&.lightbox--active {
			/* structure */
			.lightbox__body,
			.lightbox__container,
			.lightbox__overlay,
			/* buttons */
			.lightbox__button {
				animation-direction: normal;
				opacity: 0;
			}

			.lightbox__body,
			.lightbox__container {
				transform: var(--dt-fade-up);
			}

			.lightbox__body {
				animation-delay: var(--dt-lb-stagger);
				animation-timing-function: var(--ease-in-quart);
			}

			.lightbox__container {
				animation-delay: var(--dt-lb-delay-body);
				animation-timing-function: var(--ease-in-quad);
			}

			.lightbox__overlay {
				animation-delay: 0s;
			}

			.lightbox__button {
				animation-delay: calc(2 * var(--dt-lb-timeframe));

				&.lightbox__next,
				&.lightbox__prev {
					animation-delay: calc(2.5 * var(--dt-lb-timeframe));
				}

				&.lightbox__next {
					transform: var(--dt-fade-left);
				}

				&.lightbox__prev {
					transform: var(--dt-fade-right);
				}
			}
		}
	}

	&,
	.lightbox__container,
	.lightbox__overlay {
		inset: 0;
		margin: auto;
	}

	&,
	.lightbox__overlay {
		height: 100%;
		position: fixed;
		width: 100%;
	}

	.lightbox__content,
	.lightbox__container {
		display: flex;
		flex-direction: column;
		position: relative;
	}

	.lightbox__content {
		gap: calc(.75 * var(--dt-gap)) var(--dt-gap);

		@media screen and (min-width: 768px) {
			display: grid;
			grid-template-columns: repeat(var(--dt-col-span), 1fr);
			row-gap: calc(.625 * var(--dt-gap));
		}
	}

	.lightbox__container {
		background-color: var(--siteBackgroundColor);
		border-radius: var(--dt-border-radius);
		box-shadow: var(--dt-box-shadow);
		max-width: 50vw;
		/* grid-area: 3 / 6 / 20 / 22; */
		overflow: hidden;
		padding: var(--dt-gap);
		place-self: center;
		width: 90%;
		z-index: 10;
	}

	.lightbox__overlay {
		background-color: rgba(0, 0, 0, .35);
		z-index: 5;
	}

	.lightbox__header,
	.lightbox__footer {
		display: flex;
		width: 100%;
	}

	.lightbox__header {
		text-align: right;
	}

	.lightbox__navigation {
		--dt-button-dimension: calc(.75 * var(--dt-button-size));

		display: flex;
		flex: 1 100%;
		justify-content: space-between;
		padding-top: calc(.375 * var(--dt-gap));
	}

	.lightbox__arrow,
	.lightbox__button {
		align-items: center;
		display: flex;
		padding: 0;
		z-index: 5;

		&[class*='prev'] {
			justify-content: flex-start;
			text-align: left;
		}

		&[class*='next'] {
			justify-content: flex-end;
			text-align: right;
		}

		&,
		& > span {
			/* cursor: pointer; */
			height: var(--dt-button-dimension);
			line-height: var(--dt-button-size);
			position: relative;
		}

		& > span {
			cursor: pointer;
			display: block;
			letter-spacing: calc(1.5 * var(--dt-letter-spacing));
			z-index: 3;
		}
	}

	.lightbox__arrow {
        flex: 1 auto;

		&:only-child {
			flex: 1 1 100%;
		}

		&.lightbox__arrow--prev {
			& > button {
				padding-right: var(--dt-space-element);
			}

			& > span {
				transform: var(--dt-fade-left);
				transform-origin: right;
			}
		}

		&.lightbox__arrow--next {
			& > button {
				padding-left: var(--dt-space-element);
			}

			& > span {
				transform: var(--dt-fade-right);
				transform-origin: left;
			}
		}

		& > span {
			font-size: calc(.625 * var(--base-font-size));
			margin-top: .75rem;
			max-width: 25%;
			opacity: 0;
			overflow-x: visible;
			text-transform: uppercase;
			white-space: nowrap;
			transition: opacity .35s var(--ease-in-out-quad) .11s,
				transform .25s var(--ease-in-out-quad) .055s;
		}

		&:hover > span {
			opacity: .5;
			transform: var(--dt-fade-base);
			transition: opacity .25s var(--ease-in-out-quad) .055s,
				transform .35s var(--ease-in-out-quad) .11s;
		}

		&:has(> :is(button, span):hover) > span {
			font-style: italic;
		}
	}

	.lightbox__button {
		--dt-button-dimension: calc(.75 * var(--dt-button-size));

		background: none;
		border: none;
		color: inherit;
		max-width: fit-content;
		opacity: 0;
		/* width: calc(.5 * var(--dt-button-dimension)); */

		&,
		& > span {
			/* height: var(--dt-button-dimension); */
			font-size: var(--dt-button-size);
		}

		&.lightbox__next,
		&.lightbox__prev {
			--dt-button-size: 2.5rem;

			& > span {
				opacity: .875;
			}
		}

		&.lightbox__close {
			position: absolute;
			right: .875rem;
            top: .5rem;

			& > span {
				opacity: .75;
			}
		}

		& > span {
			background-color: var(--siteBackgroundColor);
			transition: opacity var(--dt-lb-time-btn) var(--ease-in-out-quad);
		}

		&:hover > span {
			opacity: 1;
		}
	}

	&.lightbox--animated:has(.fe-block.lightbox--animated) {
		.fe-block.lightbox--animated {
			animation-fill-mode: forwards;

			&.lightbox__html {
				animation-name: fadeInDown;
			}

			&.lightbox__image,
			&.lightbox__video {
				animation-duration: .75s;
				animation-name: fadeIn;
			}
		}

		&:not(.lightbox--active) {
			.fe-block.lightbox--animated {
				opacity: 1;

				&.lightbox__html {
					animation-name: fadeInUp;
					animation-direction: reverse;
					animation-timing-function: var(--ease-out-sine);
					transform: var(--dt-fade-base);
				}

				&.lightbox__video {
					animation-delay: 1s;
					animation-direction: reverse;
					animation-timing-function: var(--ease-out-sine);
				}
			}
		}

		&.lightbox--active {
			.fe-block.lightbox--animated {
				opacity: 0;

				&.lightbox__html {
					animation-name: fadeInDown;
					animation-timing-function: var(--ease-in-sine);
					transform: var(--dt-fade-down);
				}

				&.lightbox__image {
					animation-delay: .5s;
					animation-direction: reverse;
					animation-timing-function: var(--ease-out-sine);
					opacity: 1;
				}

				&.lightbox__video {
					animation-timing-function: var(--ease-in-sine);
				}
			}
		}
	}

	.fe-block {

		&.lightbox__html {
			letter-spacing: var(--dt-letter-spacing);

			@media screen and (min-width: 768px) {
				&:nth-last-child(2) {
					grid-column: 1 / span 2;
				}

				&:nth-last-child(1) {
					/* background-color: var(--menuOverlayBackgroundColor); */
					background-color: rgba(0, 0, 0, .35);
					border-radius: var(--dt-border-radius);
					grid-column: 3 / span 1;
					padding: calc(.25 * var(--dt-gap)) calc(.5 * var(--dt-gap));
				}
			}

			p {
				margin-block: .625rem;
				white-space: normal !important;

				&:not(:has(> strong)) {
					font-size: calc(.75 * var(--base-font-size));
					font-weight: 100;
				}

				&:has(> strong) {
					font-size: calc(.89 * var(--base-font-size));
					margin-block: .75rem;
				}

				&:first-child,
				&:only-child {
					margin-top: 0;
				}

				&:last-child,
				&:only-child {
					margin-bottom: 0;
				}

				&:only-child {
					line-height: 1.75;
				}

				strong {
					display: block;
				}
			}
		}


		&.lightbox__image,
		&.lightbox__video {
			background-color: rgba(0, 0, 0, .2);
			border-radius: var(--dt-border-radius);
			overflow-y: hidden;

			@media screen and (min-width: 768px) {
				grid-area: 1 / 1 / var(--dt-col-span) / 4;
			}
		}

		&.lightbox__image {
			&:has(+ .lightbox__video) {
				/* animation: fadeIn 1.75s var(--ease-out-sine) 1s reverse forwards;
				opacity: 1; */
				pointer-events: none;
				position: absolute;
				width: 100%;
				z-index: 20;

				/* & + .lightbox__video {
					animation: fadeIn 1.75s var(--ease-in-sine) .5s forwards;
					opacity: 0;
				} */
			}

			.fluid-image-container {
				min-height: var(--dt-media-size);
			}
		}

		&.lightbox__video {
			/* animation: fadeIn 1.75s var(--ease-in-sine) .5s forwards; */
			position: relative;
			z-index: 10;

			.lightbox__video-player {
				height: 100%;
				overflow: hidden;
				padding-top: 56.25%;
				position: relative;
			}

			.lightbox__video-wrapper {
				/* max-height: var(--dt-media-size); */
				min-width: auto;
				overflow: hidden;

				&,
				& > * {
					inset: 0;
					margin: auto;
					overflow: hidden;
					position: absolute;
				}

				& > * {
					border-radius: inherit;
					height: 100%;
					width: 100%;
				}
			}

		}
	}

	.sqs-block {
		padding: 0;
	}
}
